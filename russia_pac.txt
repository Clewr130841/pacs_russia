var privateNet = [
  ["10.0.0.0", "255.0.0.0"],
  ["127.0.0.0", "255.0.0.0"],
  ["172.16.0.0", "255.240.0.0"],
  ["192.168.0.0", "255.255.0.0"],
]

var proxyList = [
  'discord.com', 'remote-auth-gateway.discord.gg', 'js.hcaptcha.com', 'newassets.hcaptcha.com', 'gateway.discord.gg', 'status.discord.com', 'cdn.discordapp.com', 'images-ext-1.discordapp.net',
  'cdn.oaistatic.com', 'chatgpt.com', 'ab.chatgpt.com', 'browser-intake-datadoghq.com', 'auth.openai.com', 'auth-cdn.oaistatic.com', 'cdn.openai.com', 'featureassets.org', 'sentinel.openai.com', 'prodregistryv2.org',
  'accounts.google.com', 'lh3.googleusercontent.com', '', 'realtime.chatgpt.com', 'ws.chatgpt.com',
  'fonts.gstatic.com', 'www.gstatic.com', 'www.youtube.com', 'googleads.g.doubleclick.net', 'i.ytimg.com', 'www.google.com', 'yt3.ggpht.com', 'fonts.googleapis.com', 'youtube.com', 'accounts.youtube.com', 
  'rr4---sn-5hne6nzk.googlevideo.com', 'static.doubleclick.net',
  'web.whatsapp.com', 'static.whatsapp.net', 'graph.whatsapp.net', 'web.whatsapp.com', 'media-hel3-1.cdn.whatsapp.net',
  '2ip.ru', "discord.com",
  "discord.gg",
  "discordapp.com",
  "discordapp.io",
  "discordapp.net",
  "discord.media",
  "discordcdn.com",
  "discordstatus.com",
  "discord-attachments-uploads-prd.storage.googleapis.com"
];

proxyList = [...new Set(proxyList)];

var direct = 'DIRECT;';
var proxy = __PROXY__;

var proxies = {};

for (var i = 0; i < proxyList.length; i++) {
  proxyList[i] = proxyList[i].toLowerCase();
  proxies[proxyList[i].split('.').splice(-2)] = true;
  proxies[proxyList[i]] = true;
  proxies[proxyList[i].split('.').splice(-2)] = true;
  proxies[dnsResolve(proxyList[i])] = true;
}


function isProxy(host) {
  if(proxies[host]) return true;

  host = host.toLowerCase();
  host = host.split('.').splice(-2)

  return proxies[host];
}

function FindProxyForURL(url, host) {
  if (isProxy(host)) {
    return proxy;
  }

  if (host.match(ip4Re)) {
    for (var i = 0; i < privateNet.length; i++) {
      if (isInNet(host, privateNet[i][0], privateNet[i][1])) return direct;
    }
  }

  return direct;
}
